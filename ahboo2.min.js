angular.module("angularExperimentApp").controller("AboutCtrl",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]});angular.module("angularExperimentApp").controller("MainCtrl",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]});angular.module("ytApp").controller("youtubePlayerController",["$scope","dataService","$modal","youtubeEmbedUtils","youtubeDataApiService","utilityService","$window",function(a,c,e,b,f,d,h){function g(b){!_.isUndefined(b)&&_.isObject(b)&&(_.each(a.playlistAry,function(a){var c=d.findIndex(a.playlist,function(a){return a.videoId==b.videoId});-1!=c&&(a.playlist[c]=angular.copy(b))}),c.editSongFromPlaylist(b))}function k(b){!_.isUndefined(b)&&_.isObject(b)&&(_.find(a.playlistAry,function(a){return a.playlistId==
b.playlistId}).name=b.name,c.editPlaylistName(b))}function m(b){a.currentPlaylist&&(a.currentPlaylist.currentlyPlaying=!1,a.currentPlaylist=b)}a.playlistAry=[];a.alerts=[];a.isOpenNewPlaylistForm=!1;a.closeAlert=function(b){a.alerts.splice(b,1)};a.loadAndPlayPlaylist=function(b){a.ytPlayer&&"paused"==a.ytPlayer.currentState?a.ytPlayer.playVideo():a.ytPlayer.loadAndPlayPlaylist&&"function"===typeof a.ytPlayer.loadAndPlayPlaylist&&(a.ytPlayer.loadAndPlayPlaylist(b),m(b))};a.loadAndPlaySong=function(b,
c){a.ytPlayer.loadAndPlaySong&&"function"===typeof a.ytPlayer.loadAndPlaySong&&(a.ytPlayer.loadAndPlaySong(b,c),m(b))};a.loadPlaylist=function(b){a.selectedPlaylist.isSelectedPlaylist=!1;b.isSelectedPlaylist=!0;a.selectedPlaylist=b};a.pauseCurrentSong=function(){a.ytPlayer.pauseVideo&&"function"===typeof a.ytPlayer.pauseVideo&&a.ytPlayer.pauseVideo()};a.playOrPause=function(b){!b.currentlyPlaying&&b.currentlyPlayed?a.ytPlayer.playVideo():b.currentlyPlaying||b.currentlyPlayed?a.ytPlayer.pauseVideo():
a.loadAndPlaySong(b,0)};a.openAddSongModal=function(){e.open({templateUrl:"addNewSong.html",controller:EditSongModalCtrl,windowClass:"add-new-song-modal",resolve:{song:function(){return null},editingSong:function(){return!1},youtubeEmbedUtils:function(){return b},youtubeDataApiService:function(){return f},utilityService:function(){return d}}}).result.then(function(b){!0===b.isValidSong&&_.isObject(a.currentPlaylist)?(b={name:b.name,artistName:b.artistName,videoId:b.videoId,duration:b.duration,videoThumbUrl:b.videoThumbUrl},
a.selectedPlaylist.playlist.push(b),c.addSongToPlaylist(a.selectedPlaylist.playlistId,b),angular.equals(a.selectedPlaylist,a.currentPlaylist)&&(a.currentPlaylist.reloadNeeded=!0),a.alerts=[],a.alerts.push({type:"success",msg:"New song is added."})):(a.alerts=[],a.alerts.push({type:"danger",msg:"Error adding new song."}))},function(){})};a.openEditSongModal=function(a){e.open({templateUrl:"addNewSong.html",controller:EditSongModalCtrl,windowClass:"add-new-song-modal",resolve:{song:function(){return a},
editingSong:function(){return!0},youtubeEmbedUtils:function(){return b},youtubeDataApiService:function(){return f},utilityService:function(){return d}}}).result.then(function(a){g(a)},function(){})};a.openEditPlaylistModal=function(a){var b=angular.copy(a);e.open({templateUrl:"editPlaylist.html",controller:EditPlaylistModalCtrl,resolve:{playlist:function(){return b}}}).result.then(function(a){k(a)},function(){})};a.openNewPlaylistForm=function(){a.isOpenNewPlaylistForm=!0};a.resetPlaylistForm=function(){a.isOpenNewPlaylistForm=
!1;a.newPlaylistName=""};a.addNewPlaylist=function(b){!_.isUndefined(a.playlistAry)&&_.isArray(a.playlistAry)&&!_.isUndefined(b)&&_.isString(b)&&(b={playlistId:a.playlistAry.length+1,name:b,isSelectedPlaylist:!1,playlist:[]},a.playlistAry.push(b),c.addNewPlaylist(b),a.loadPlaylist(a.playlistAry[a.playlistAry.length-1]),a.resetPlaylistForm())};a.deletePlaylist=function(b){if(h.confirm("Are you sure to delete this playlist")){var e=d.findIndex(a.playlistAry,function(a){return a.playlistId==b.playlistId});
a.playlistAry.splice(e,1);c.deletePlaylist(b);0<e&&a.loadPlaylist(a.playlistAry[e-1])}};a.isPlaylistEmpty=function(a){return _.isUndefined(a)||_.isUndefined(a.playlist)||!_.isArray(a.playlist)||0==a.playlist.length};a.deleteSongFromPlaylist=function(b,d,e){b.playlist[e].videoId==d.videoId&&(b.playlist.splice(e,1),c.deleteSongFromPlaylist(b.playlistId,d,e),angular.equals(a.selectedPlaylist,a.currentPlaylist)&&(a.currentPlaylist.reloadNeeded=!0))};(function(){a.playlistAry=c.getPlaylistData();a.currentPlaylist=
_.find(a.playlistAry,function(a){return!0===a.isSelectedPlaylist});a.selectedPlaylist={};a.loadPlaylist(a.currentPlaylist)})()}]);
var EditSongModalCtrl=function(a,c,e,b,f,d,h){function g(b){if(_.isObject(b)&&_.isObject(b.pageInfo)&&1==b.pageInfo.totalResults){b=b.items[0];a.song.name=b.snippet.title;var c=a.song,d;d=h.convertYoutubeDurationString(b.contentDetails.duration);d=h.convertMiliSecondToHhmmss(d);c.duration=d;a.song.videoThumbUrl=b.snippet.thumbnails.medium.url;a.song.videoId=b.id;a.song.isValidSong=!0;a.isUrlLoaded=!0}else a.song.isValidSong=!1}function k(){a.song.isValidSong=!1}a.isUrlLoaded=!1;a.editingSong=b;a.saveText=
b?"Edit":"Add New";a.editingSong?(a.song=angular.copy(e),a.isUrlLoaded=!0):a.song={};a.ok=function(b){b.$valid&&c.close(a.song)};a.checkYoutubeUrl=function(a){a=f.getIdFromURL(a);d.getVideoDataById(a).then(g,k)};a.cancel=function(){c.dismiss("cancel")}},EditPlaylistModalCtrl=function(a,c,e){!_.isUndefined(e)&&_.isObject(e)&&(a.playlist=e);a.ok=function(b){b.$valid&&c.close(a.playlist)};a.cancel=function(){c.dismiss("cancel")}};angular.module("ab.directives").directive("hideOnHover",[function(){return{restrict:"A",link:function(a,c,e){a=e.hideOnHover.split(",");var b="";_.each(a,function(a,c){0<c&&(b+=",");b+="."+a});var f=$(c);f.on("mouseenter",function(){f.find(b).hide()});f.on("mouseleave",function(){f.find(b).show()})}}}]);angular.module("ab.directives").directive("showHideOutsideElement",["$timeout",function(a){return{restrict:"A",link:function(c,e,b){var f=angular.element(b.showHideOutsideElement);c.elementMouseLeave=!0;c.outsideElementMouseLeave=!0;e.on("mouseenter",function(){f.clearQueue();f.show();c.elementMouseLeave=!1});e.on("mouseleave",function(){a(function(){!0===c.outsideElementMouseLeave&&!0===c.elementMouseLeave&&f.slideUp()},500);c.elementMouseLeave=!0});f.on("mouseenter",function(){c.outsideElementMouseLeave=
!1});f.on("mouseleave",function(){a(function(){!0===c.outsideElementMouseLeave&&!0===c.elementMouseLeave&&f.slideUp()},1500);c.outsideElementMouseLeave=!0})}}}]);angular.module("ab.directives").directive("showOnHover",[function(){return{restrict:"A",link:function(a,c,e){var b=e.showOnHover,f=$(c);f.on("mouseenter",function(){f.find("."+b).show()});f.on("mouseleave",function(){f.find("."+b).hide()})}}}]);angular.module("ui.slider",[]).value("uiSliderConfig",{}).directive("uiSlider",["uiSliderConfig","$timeout",function(a,c){a=a||{};return{require:"ngModel",compile:function(){return{pre:function(e,b,f,d){function h(a,b){return b?parseFloat(a):parseInt(a,10)}var g=angular.extend(e.$eval(f.uiSlider)||{},a),k=null,m=null,n=["min","max","step"],l=angular.isUndefined(f.useDecimals)?!1:!0,p=function(){angular.isArray(d.$viewValue)&&!0!==g.range&&(console.warn("Change your range option of ui-slider. When assigning ngModel an array of values then the range option should be set to true."),
g.range=!0);angular.forEach(n,function(a){angular.isDefined(f[a])&&(g[a]=h(f[a],l))});b.slider(g);p=angular.noop};angular.forEach(n,function(a){f.$observe(a,function(c){c&&(p(),g[a]=h(c,l),b.slider("option",a,h(c,l)),d.$render())})});f.$observe("disabled",function(a){p();b.slider("option","disabled",!!a)});e.$watch(f.uiSlider,function(a){p();void 0!==a&&b.slider("option",a)},!0);c(p,0,!0);b.bind("slide",function(a,b){d.$setViewValue(b.values||b.value);e.$apply()});d.$render=function(){p();var a=!0===
g.range?"values":"value";g.range||!isNaN(d.$viewValue)||d.$viewValue instanceof Array?g.range&&!angular.isDefined(d.$viewValue)&&(d.$viewValue=[0,0]):d.$viewValue=0;!0===g.range&&(angular.isDefined(g.min)&&g.min>d.$viewValue[0]&&(d.$viewValue[0]=g.min),angular.isDefined(g.max)&&g.max<d.$viewValue[1]&&(d.$viewValue[1]=g.max),d.$viewValue[0]>d.$viewValue[1]&&(k>=d.$viewValue[1]&&(d.$viewValue[0]=k),m<=d.$viewValue[0]&&(d.$viewValue[1]=m)),k=d.$viewValue[0],m=d.$viewValue[1]);b.slider(a,d.$viewValue)};
e.$watch(f.ngModel,function(){!0===g.range&&d.$render()},!0);e.$on("$destroy",function(){b.slider("destroy")})},post:function(a,b,c,d){var h=angular.extend({},a.$eval(c.uiSlider));angular.forEach(["max","step","tick"],function(a){angular.isDefined(c[a])&&(h[a]=c[a])});if(angular.isDefined(h.tick)&&angular.isDefined(h.step))for(d=a=parseInt(parseInt(h.max)/parseInt(h.step));0<=d;d--){var g=d/a*100+"%";$("<div/>").addClass("ui-slider-tick").appendTo(b).css({left:g})}}}}}}]);angular.module("ab.directives").directive("sliderHover",["$animate",function(a){return{restrict:"A",link:function(c,e,b){b=$(e);b.on("mouseenter",function(){a.addClass(e,"slider-hover");c.$digest()});b.on("mouseleave",function(){a.removeClass(e,"slider-hover");c.$digest()})}}}]);angular.module("ytApp").directive("ytPlayer",["$http","youtubeEmbedUtils","$interval",function(a,c,e){return{restrict:"E",templateUrl:"views/templates/ytPlayer.html",replace:!0,scope:{videoId:"=?",videoUrl:"=?",customPlayer:"=?",playlist:"=?"},link:function(a,f,d){function h(c){!0===c.reloadNeeded&&(c.reloadNeeded=!1,a.player.loadAndPlaySong&&"function"===typeof a.player.loadAndPlaySong&&a.player.loadAndPlaySong(c,!0===a.player.isShuffle?Math.floor(Math.random()*(a.playlist.length-1)+0):a.currentSong.videoIndex+
1))}function g(){var d=a.player.getVideoUrl(),e=c.getIdFromURL(d);a.currentSong&&(a.currentSong.currentlyPlaying=!1);n.currentlyPlayed=!1;d=_.find(a.playlist.playlist,function(a,b){a.videoIndex=b;a.currentlyPlaying=a.videoId===e?!0:!1;return a.videoId===e});a.currentSong=d;k(a.currentSong);a.playlist.currentlyPlaying=!0;n=a.playlist;n.currentlyPlayed=!0}function k(c){var d=a.player.getDuration();a.currentlyPlayingSongInfo.name=c.name;a.currentlyPlayingSongInfo.artistName=c.artistName;a.currentlyPlayingSongInfo.videoDuration=
d;a.sliderOptions.max=d}function m(){a.stopInterval=e(function(){l||(a.currentlyPlayingSongInfo.currentTime=a.player.getCurrentTime(),a.currentlyPlayingSongInfo.DurationLeft=a.currentlyPlayingSongInfo.videoDuration-a.currentlyPlayingSongInfo.currentTime)},500)}var n={};a.isShuffle=!1;a.isRepeat=!1;a.currentlyPlayingSongInfo={};a.currentSong=null;a.sliderOptions={orientation:"horizontal",min:0,max:0};a.volumnSliderOptions={orientation:"horizontal",min:0,max:100,tooltip:"hidden"};a.sliderInfo={sliderOnOneSecondWait:!1,
sliderPositionToChange:null};var l=!1;a.backward=function(){a.player.previousVideo()};a.forward=function(){!0===a.playlist.reloadNeeded?h(a.playlist):a.player.nextVideo()};a.playPause=function(){"playing"==a.player.currentState?a.player.pauseVideo():a.player.playVideo()};a.toggleShuffle=function(){a.player&&(a.player.isShuffle=!a.player.isShuffle)};a.toggleRepeat=function(){a.player&&(a.player.isRepeat=!a.player.isRepeat)};a.$on("youtube.player.ready",function(c,d){a.customPlayer=a.player;a.customPlayer.volume=
50});a.$on("youtube.player.queued",function(d,e){var g=a.player.getVideoUrl(),f=c.getIdFromURL(g),g=_.find(a.playlist.playlist,function(a,b){a.videoIndex=b;return a.videoId===f});a.currentSong=g;k(a.currentSong)});a.$on("youtube.player.playing",function(a,b){g();m()});a.$on("youtube.player.paused",function(c,d){a.currentSong&&(a.currentSong.currentlyPlaying=!1,a.playlist.currentlyPlaying=!1)});a.$on("youtube.player.unstarted",function(c,d){h(a.playlist)});a.startDragging=function(){l=!0};a.stopDragging=
function(c){l=!1;a.player.seekTo(c,!0)};a.$watch("player.volume",function(){_.isObject(a.player)&&_.isFunction(a.player.setVolume)&&a.player.setVolume(a.player.volume)});a.playerVars={customPlaylist:a.playlist.playlist};a.$watch("currentlyPlayingSongInfo.currentTime",function(c){l&&a.player.seekTo(c,!1)});String.prototype.toHHMMSS=function(){var a=parseInt(this,10),b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60),a=a-3600*b-60*c;10>a&&(a="0"+a);return 1>b?c+":"+a:b+":"+c+":"+a}}}}]);angular.module("ab.services").factory("dataService",["localStorageService","appSettings","utilityService",function(a,c,e){function b(){var b=a.load(c.localStorageKey.playlist);return _.isUndefined(b)||_.isNull(b)}function f(a,b){return _.find(b,function(b){return b.playlistId==a})}return{getPlaylistData:function(){if(b()){var d=[{playlistId:1,name:"Sample playlist",isSelectedPlaylist:!0,playlist:[{name:"Thiake Ma Ket Bu",artistName:"Tin Zar Maw",videoId:"W2Z3GWt8v9w"},{name:"Mhar Pyan Dal",artistName:"Chan Chan",
videoId:"9BImfRpcsHg"},{name:"Tun Eindra Bo - Live Concert - 8",artistName:"Tun Eindra Bo",videoId:"OHxgbwyoQtA"},{name:"Tate Ta Khoe",artistName:"Bobby Soxer ft Ye' Lay",videoId:"l7SPUVUPQCo"}]},{playlistId:2,name:"Playlist 1",isSelectedPlaylist:!1,playlist:[]}];this.savePlaylistData(d);return d}return a.load(c.localStorageKey.playlist)},savePlaylistData:function(b){a.save(c.localStorageKey.playlist,b)},addSongToPlaylist:function(d,e){if(_.isNumber(d)&&_.isObject(e)&&!b()){var g=a.load(c.localStorageKey.playlist),
k=f(d,g);_.isObject(k)&&null!=g&&(k.playlist.push(e),a.save(c.localStorageKey.playlist,g))}},deleteSongFromPlaylist:function(d,e,g){if(_.isNumber(d)&&_.isObject(e)&&_.isNumber(g)&&!b()){var k=a.load(c.localStorageKey.playlist);d=f(d,k);_.isObject(d)&&d.playlist.length>=g+1&&(d.playlist[g].videoId==e.videoId&&d.playlist.splice(g,1),a.save(c.localStorageKey.playlist,k))}},editSongFromPlaylist:function(d){if(_.isObject(d)&&_.isString(d.videoId)&&!b()){var f=a.load(c.localStorageKey.playlist);_.each(f,
function(a){var b=e.findIndex(a.playlist,function(a){return a.videoId==d.videoId});-1!=b&&(a.playlist[b]=angular.copy(d))});a.save(c.localStorageKey.playlist,f)}},addNewPlaylist:function(d){if(!_.isUndefined(d)&&_.isObject(d)&&!b()){var e=a.load(c.localStorageKey.playlist);e.push(d);a.save(c.localStorageKey.playlist,e)}},deletePlaylist:function(d){if(!_.isUndefined(d)&&_.isObject(d)&&!b()){var e=a.load(c.localStorageKey.playlist),f=-1;_.each(e,function(a,b){a.playlistId==d.playlistId&&(f=b)});-1<
f&&(e.splice(f,1),a.save(c.localStorageKey.playlist,e))}},editPlaylistName:function(d){if(!_.isUndefined(d)&&_.isString(d)&&!b()){var e=a.load(c.localStorageKey.playlist);_.find(e,function(a){return a.playlistId==d.playlistId}).name=d.name;a.save(c.localStorageKey.playlist,e)}}}}]);angular.module("ab.services").factory("localStorageService",["$window",function(a){return{save:function(c,e){"undefined"!==typeof a.localStorage&&null!=a.localStorage&&a.localStorage.setItem(c,JSON.stringify(e))},remove:function(c){"undefined"!==typeof a.localStorage&&null!=a.localStorage&&a.localStorage.removeItem(c)},load:function(c){if("undefined"===typeof a.localStorage||null==a.localStorage)return null;c=a.localStorage.getItem(c);if("undefined"!==typeof c&&null!=c&&""!=c){var e=null;try{e=JSON.parse(c)}catch(b){}return e}}}}]);angular.module("ab.services").factory("utilityService",[function(){return{convertYoutubeDurationString:function(a){var c=a.match(/\d+/g);0<=a.indexOf("M")&&-1==a.indexOf("H")&&-1==a.indexOf("S")&&(c=[0,c[0],0]);0<=a.indexOf("H")&&-1==a.indexOf("M")&&(c=[c[0],0,c[1]]);0<=a.indexOf("H")&&-1==a.indexOf("M")&&-1==a.indexOf("S")&&(c=[c[0],0,0]);a=0;3==c.length&&(a+=3600*parseInt(c[0]),a+=60*parseInt(c[1]),a+=parseInt(c[2]));2==c.length&&(a+=60*parseInt(c[0]),a+=parseInt(c[1]));1==c.length&&(a+=parseInt(c[0]));
return a},convertMiliSecondToHhmmss:function(a){var c=parseInt(a,10);a=Math.floor(c/3600);var e=Math.floor((c-3600*a)/60),c=c-3600*a-60*e;10>c&&(c="0"+c);return 1>a?e+":"+c:a+":"+e+":"+c},findIndex:function(a,c){var e=-1;_.each(a,function(a,f){c(a)&&(e=f)});return e}}}]);angular.module("ab.services").factory("youtubeDataApiService",["$q",function(a){function c(a){if(_.isBoolean(isYoutubeDataApiLoaded)&&!0===isYoutubeDataApiLoaded)return gapi.client.youtube.videos.list({id:a,part:"snippet,status,contentDetails"})}return{getVideoDataById:function(e){var b=a.defer();c(e).execute(function(a){b.resolve(a)});return b.promise}}}]);